<div class="sunset cards-canvas">
  <main class="cards-list">
    <div class="card form-card">
      <h2>Create post</h2>
      <form action="<%= createPostPath %> " enctype="multipart/form-data" method="post">
        <label for="imageLink">Image URL</label>
        <input type="url" name="imageLink" value="" />
        <label for="body">Say something!</label>
        <textarea name="body" value="" placeholder="What's on your mind?"></textarea> 
        <button class="submit-button" type="submit">Post</button>
      </form>
    </div>

    <% posts.forEach((post, index) => { %>
      <% const user = post.User %> 
      
      <div class="card index-post">
        <div class="card__image">
          <a href="<%= showPostPath(post.id) %>">
            <img src="<%= post.imageLink %>"/>
          </a>
        </div>
        <div class="card__info">
          <div class="card__info__user">
            <a href="<%= showUserPath(user.id) %>"
              ><img
                class="poster-user-picture"
                src="<%= user.avatarLink %> "
                alt="Profile picture"
            /></a>
            <h3>@<%= `${user.firstName} ${user.lastName}` %></h3>
          </div>
          <p class="card__info__extra"><%= post.body %> </p>
        </div>
        <div class="card__stats">
          <p class="card__stats__title">Likes</p>
          <div class="card__stats__info">
            <div class="card__stats__info__multi">
              <h5><%= postsLikeCount[index] %> </h5>
              <% if (userIsLoggedIn && likedPosts) { %>
                <form action="<%- likedPosts[index] ? unlikePostPath(post.id) : likePostPath(post.id) %>" method="POST">
                  <button type="submit">
                    <span class="material-icons"><%= likedPosts[index] ? 'airplanemode_inactive' : 'airplanemode_active' %></span>
                  </button>
                </form>
              <% } %>
            </div>
          </div>
        </div>
        <div class="card__stats">
          <p class="card__stats__title">Date</p>
          <h5 class="card__stats__info"><%= post.createdAt.toLocaleString('ISO') %> </h5>
        </div>
        <% if (userIsLoggedIn && currentUser.id === post.userId) { %>
          <div class="card__stats">
          </div>
          <div class="card__stats">
            <p class="card__stats__title">Edit post</p>
            <a href="<%= editPostPath(post.id) %> "><span class="material-icons">edit</span></a>
          </div>
          <div class="card__stats">
            <p class="card__stats__title">Delete post</p>
            <div class="card__stats__info">
              <form action="<%- deletePostPath(post.id) %>" method="POST">
                <input type="hidden" name="_method" value="delete" />
                <button type="submit">
                  <span class="material-icons">delete</span>
                </button>
              </form>
            </div>
          </div>
         
        <% } %>
      </div>
    <% }) %>
    <div id= "page-buttons">
      <% if (page > 1) { %>
        <a class="submit-button" href="<%= nextPagePath(page - 1) %>">Previous page</a>
      <% } %>
      <p>Page <%= page %></p>
      <% if (hasNextPage) { %>
        <a class="submit-button" href="<%= nextPagePath(page + 1) %>">Next page</a>
      <% } %>
    </div>

  </main>
  <aside id="sidebar">
    <p class="sidebar-header">Random Post</p>
    <% if (randomPost) { %>
      <div class= "sidebar-randompost__image">
        <a href="<%= showPostPath(randomPost.id) %>">
          <img src="<%= randomPost.imageLink %>"/>
        </a>
      </div>
    <% } else { %>
      <p>Oops! Could not retrieve a random post.</p>
    <% } %>
    <p class="sidebar-header">More Cool Posts</p>
    <% if (randomPost) { %>
      <div class= "sidebar-randompost__image">
        <% randomPosts.forEach((post, index) => { %>
          <a href="<%= showPostPath(post.id) %>">
            <img src="<%= post.imageLink %>"/>
          </a>
        <% }) %>
      </div>
    <% } else { %>
      <p>Oops! No more posts to show.</p>
    <% } %>
  </aside>
</div>
